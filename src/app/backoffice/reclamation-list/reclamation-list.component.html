<div class="container mt-4">
  <h2 class="text-center text-primary mb-4">Liste des Réclamations</h2>
  <div class="d-flex justify-content-between mb-3">
    <button class="btn btn-success" (click)="addComplaint()">
      <i class="fas fa-plus"></i> Add Complaint
    </button>
    <div class="input-group w-50">
      <label class="input-group-text" for="typeFilter">Rechercher par Type:</label>
      <select class="form-select" id="typeFilter" [(ngModel)]="selectedType">
        <option value="">Tous</option>
        <option *ngFor="let type of complaintTypes" [value]="type">{{ type }}</option>
      </select>
      <button class="btn btn-primary" (click)="filterComplaints()">
        <i class="fas fa-search"></i> Rechercher
      </button>
    </div>
  </div>
  <table class="table table-striped table-hover">
    <thead class="thead-dark">
      <tr>
        <th>Titre</th>
        <th>Description</th>
        <th>Type</th>
        <th>Date de Création</th>
        <th>Date de Dernière Modification</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let complaint of filteredComplaints">
        <td>{{ complaint.title }}</td>
        <td>{{ complaint.description }}</td>
        <td>{{ complaint.type }}</td>
        <td>{{ complaint.creationDate | date:'short' }}</td>
        <td>{{ complaint.lastModifiedDate | date:'short' }}</td>
        <td [ngClass]="getStatusClass(complaint.status)">{{ complaint.status }}</td>
        <td>
          <button class="btn btn-primary mb-2 me-2" (click)="editComplaint(complaint.id)">
            <i class="fas fa-edit"></i> Modifier
          </button>
          <button class="btn btn-danger mb-2 me-2" (click)="deleteComplaint(complaint.id)">
            <i class="fas fa-trash-alt"></i> Supprimer
          </button>
          <button class="btn btn-info mb-2 me-2" (click)="openModal(complaint)">
            <i class="fas fa-eye"></i> Voir Détail
          </button>
          <button class="btn btn-secondary mb-2" (click)="handleComplaint(complaint.id)">
            <i class="fas fa-cogs"></i> Traiter
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Modal -->
  <div class="modal fade" id="complaintModal" tabindex="-1" aria-labelledby="complaintModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-primary" id="complaintModalLabel">{{ selectedComplaint?.title }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3"><strong>Titre:</strong> {{ selectedComplaint?.title }}</div>
          <div class="mb-3"><strong>Description:</strong> {{ selectedComplaint?.description }}</div>
          <div class="mb-3"><strong>Date de Création:</strong> {{ selectedComplaint?.creationDate | date:'short' }}</div>
          <div class="mb-3"><strong>Type:</strong> {{ selectedComplaint?.type }}</div>
          <div class="mb-3"><strong>Status:</strong> <span [ngClass]="getStatusClass(selectedComplaint?.status)">{{ selectedComplaint?.status }}</span></div>
        </div>
      </div>
    </div>
  </div>
</div>