<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - SPEEDYGO</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        body {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f8f9fa;
            padding: 20px;
        }
        .card {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            border-radius: 10px;
            overflow-y: auto;
            max-height: 90vh;
        }
    </style>
</head>
<body>
    <div class="register-container">
        <!-- Current Time & User Display -->
        <div class="time-user-display">
          <p>Current Date and Time (UTC - YYYY-MM-DD HH:MM:SS formatted): {{ currentTime }}</p>
        </div>
      
        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
          <div class="card shadow-lg border-0">
            <!-- Logo -->
            <div class="text-center mb-3">
              <div class="d-inline-flex align-items-center">
                <svg class="text-primary me-2" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2a3 3 0 0 0-3 3c0 1.7 1.3 3 3 3s3-1.3 3-3a3 3 0 0 0-3-3z"/>
                  <path d="M19 9a3 3 0 0 0-3-3h-2a3 3 0 0 0-2 .8a3 3 0 0 0-2-.8H8a3 3 0 0 0-3 3v11h14V9z"/>
                </svg>
                <span class="h4 mb-0 text-primary">
                  <span class="fw-bold">Assurance</span>Maghrebia
                </span>
              </div>
            </div>
      
            <!-- Title -->
            <h1 class="h4 text-center mb-3">Admin Registration</h1>
            <p class="text-muted text-center mb-4">Create a new admin account</p>
      
            <!-- Alert for errors -->
            <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
              {{ error }}
              <button type="button" class="btn-close" (click)="error = ''"></button>
            </div>
      
            <!-- Alert for success -->
            <div *ngIf="success" class="alert alert-success alert-dismissible fade show" role="alert">
              {{ success }}
              <button type="button" class="btn-close" (click)="success = ''"></button>
            </div>
      
            <!-- Register Form -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="firstName" class="form-label">First Name</label>
                <input id="firstName" formControlName="firstName" class="form-control" 
                      [ngClass]="{ 'is-invalid': submitted && f['firstName'].errors }" />
                <div *ngIf="submitted && f['firstName'].errors" class="invalid-feedback">
                  <div *ngIf="f['firstName'].errors['required']">First name is required</div>
                </div>
              </div>
      
              <div class="col-md-6 mb-3">
                <label for="lastName" class="form-label">Last Name</label>
                <input id="lastName" formControlName="lastName" class="form-control"
                      [ngClass]="{ 'is-invalid': submitted && f['lastName'].errors }" />
                <div *ngIf="submitted && f['lastName'].errors" class="invalid-feedback">
                  <div *ngIf="f['lastName'].errors['required']">Last name is required</div>
                </div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="email" class="form-label">Email</label>
              <input id="email" formControlName="email" type="email" class="form-control"
                    [ngClass]="{ 'is-invalid': submitted && f['email'].errors }" />
              <div *ngIf="submitted && f['email'].errors" class="invalid-feedback">
                <div *ngIf="f['email'].errors['required']">Email is required</div>
                <div *ngIf="f['email'].errors['email']">Email must be a valid email address</div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <input id="password" formControlName="password" type="password" class="form-control"
                    [ngClass]="{ 'is-invalid': submitted && f['password'].errors }" />
              <div *ngIf="submitted && f['password'].errors" class="invalid-feedback">
                <div *ngIf="f['password'].errors['required']">Password is required</div>
                <div *ngIf="f['password'].errors['minlength']">Password must be at least 6 characters</div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="confirmPassword" class="form-label">Confirm Password</label>
              <input id="confirmPassword" formControlName="confirmPassword" type="password" class="form-control"
                    [ngClass]="{ 'is-invalid': submitted && (f['confirmPassword'].errors || registerForm.hasError('passwordMismatch')) }" />
              <div *ngIf="submitted && (f['confirmPassword'].errors || registerForm.hasError('passwordMismatch'))" class="invalid-feedback">
                <div *ngIf="f['confirmPassword'].errors?.['required']">Password confirmation is required</div>
                <div *ngIf="registerForm.hasError('passwordMismatch')">Passwords must match</div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="birthday" class="form-label">Date of Birth</label>
              <input id="birthday" formControlName="birthday" type="date" class="form-control"
                    [ngClass]="{ 'is-invalid': submitted && f['birthday'].errors }" />
              <div *ngIf="submitted && f['birthday'].errors" class="invalid-feedback">
                <div *ngIf="f['birthday'].errors['required']">Date of Birth is required</div>
              </div>
            </div>
      
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="identityType" class="form-label">Identity Type</label>
                <select id="identityType" formControlName="identityType" class="form-select"
                      [ngClass]="{ 'is-invalid': submitted && f['identityType'].errors }">
                  <option *ngFor="let type of identityTypes" [value]="type">{{ type }}</option>
                </select>
                <div *ngIf="submitted && f['identityType'].errors" class="invalid-feedback">
                  <div *ngIf="f['identityType'].errors['required']">Identity Type is required</div>
                </div>
              </div>
              
              <div class="col-md-6 mb-3">
                <label for="numberOfIdentity" class="form-label">Identity Number</label>
                <input id="numberOfIdentity" formControlName="numberOfIdentity" type="text" class="form-control"
                      [ngClass]="{ 'is-invalid': submitted && f['numberOfIdentity'].errors }" />
                <div *ngIf="submitted && f['numberOfIdentity'].errors" class="invalid-feedback">
                  <div *ngIf="f['numberOfIdentity'].errors['required']">Identity Number is required</div>
                </div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="phoneNumber" class="form-label">Phone Number</label>
              <input id="phoneNumber" formControlName="phoneNumber" type="text" class="form-control"
                    [ngClass]="{ 'is-invalid': submitted && f['phoneNumber'].errors }" />
              <div *ngIf="submitted && f['phoneNumber'].errors" class="invalid-feedback">
                <div *ngIf="f['phoneNumber'].errors['required']">Phone Number is required</div>
                <div *ngIf="f['phoneNumber'].errors['pattern']">Phone Number must be 8 digits</div>
              </div>
            </div>
      
            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <textarea id="address" formControlName="address" class="form-control"
                      [ngClass]="{ 'is-invalid': submitted && f['address'].errors }"></textarea>
            </div>
      
            <button type="submit" class="btn btn-primary w-100" [disabled]="loading">
              <span *ngIf="loading" class="spinner-border spinner-border-sm me-1"></span>
              Register as Admin
            </button>
          </div>
      
          <div class="text-center mt-3">
            <span class="text-muted">Already have an account?</span>
            <a routerLink="/backoffice/login" class="btn btn-outline-primary ms-2">Log in</a>
          </div>
        </form>
      </div>